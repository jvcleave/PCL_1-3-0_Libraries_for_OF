%---------------------------Maximum Aspect Frobenius---------------------------
\section{Maximum Aspect Frobenius}

For hexahedra, there is not a unique definition of the aspect Frobenius.
Instead, we use the aspect Frobenius
defined for tetrahedra (see section~\S\ref{s:tet-aspect-Frobenius}),
but choose the reference $W$ element to be right isosceles at
the hexahedral corner. Consider the eight tetrahedra formed by edges
incident to the corner of a hexahedron. 
Given a corner vertex $i$ and its three adjacent vertices $j$, $k$, and $\ell$ ordered
in a clockwise manner (so that $ijk\ell$ is a positively oriented tetrahedron),
denote the tetrahedral aspect frobenius of that corner as $F_{ijk\ell}$.
To obtain a single value for the metric, we take the maximum value of the eight unique tetrahedral aspects
\[
  q = \max\left(F_{0134}, F_{1205}, F_{2316}, F_{3027}, F_{4750}, F_{5461}, F_{6572}, F_{7643} \right).
\]

In the past, this metric was called the condition number and computed 
in terms of the Jacobian matrices $A_i$ and
their determinants $\alpha_i$ as in \S\ref{s:hex}.
We provide that method of computation below for reference purposes.
First, define
\[
\kappa(A_i)
  = \left|A_i\right| \left|A_i^{-1}\right|
  = \frac {\left|A_i\right| \left|\mathrm{adj}(A_i)\right|}{\alpha_i}.
\]
There are 9 of these matrices and we evaluate the condition number at each and take a third of the maximum:
\[
q = \frac {1}{3} \max\left\{ \kappa(A_0), \kappa(A_1), \ldots, \kappa(A_8) \right\}
\]
The first 8 matrices represent the condition at the corners and the last represents the condition number
at the element's center.
Note that if $\alpha_i \leq DBL\_MIN$, for any $i$, then $q = DBL\_MAX$.

\hexmetrictable{maximum aspect frobenius}%
{$1$}%                                        Dimension
{$[1,3]$}%                                    Acceptable range
{$[1,DBL\_MAX]$}%                             Normal range
{$[1,DBL\_MAX]$}%                             Full range
{$1$}%                                        Cube
{\cite{knu:00}}%                              Citation
{v\_hex\_max\_aspect\_frobenius \textnormal{or} %
 v\_hex\_condition$^*$}%                      Verdict function name

\noindent\,$^*$ indicates a function that is deprecated and may be removed in future versions of \verd.
